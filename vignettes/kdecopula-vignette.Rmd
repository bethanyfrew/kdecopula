---
title: "The `kdecopula` package"
author: "Thomas Nagler"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

In this document, we demonstrate the main capabilities of the `kdecopula` package. All user-level functions will be introduced and demonstrated on simulated data.
```{r}
library(kdecopula)
```

First we simulate data from a Clayton copula with parameter $\theta = 3$ via the `BiCopSim` function of the `VineCopula` package.

```{r fig.width=4, fig.height=4}
library(VineCopula)
clay3 <- BiCop(family = 3, par = 3)
u <- BiCopSim(500, clay3)
plot(u)
```


Estimation of bivariate copula densities
-------------------------

We start by estimating the copula density with the `kdecop` function. There is a number of options for the smoothing parameterization, estimation method and evaluation grid, but it is only required to provide a data-matrix.

```{r}
kde.fit <- kdecop(u, info = TRUE)
kde.fit$info$AIC
```

The additional option `info=TRUE` provides extra information like *AIC* or *effective number of parameters*; default is `FALSE`. The output of the function is an object of class `kdecopula` that contains all information collected during the process. 

Working with a `kdecopula` object
-------------------------

The density and *cdf* can be computed easily:

```{r}
dkdecop(c(0.1, 0.2), kde.fit)
pkdecop(c(0.1, 0.2), kde.fit)
```

Furthermore, we can simulate synthetic data from the estimated density:
```{r fig.width=4, fig.height=4}
unew <- rkdecop(500, kde.fit)
plot(unew)
```

Plotting bivariate copula densities
-------------------------

The most interesting part for most people is probably to make exploratory plots. The class `kdecopula` has its own generic for plotting. In general, there are two possible types of plots: *contour* and *surface* (or perspective) plots. Additionally, the `margins` argument allows to choose between a plot of the original copula density and a meta-copula density with standard normal margins (default for `type = contour`).
```{r fig.width=4, fig.height=4}
plot(kde.fit)
```

The `...` argument furthermore allows to modify the parameters of the `contour` or `wireframe` functions.

```{r fig.width=4, fig.height=4}
plot(kde.fit, margins = "unif", col = 5:1)
```
```{r fig.width=4, fig.height=4}
plot(kde.fit, type = "surface", xlab = "test")
```

